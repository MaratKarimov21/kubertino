# Kubertino Configuration File
# Copy this file to ~/.kubertino.yml and customize for your environment

version: "1.0"

# Optional: Override default kubeconfig path
kubeconfig: ~/.kube/config

# Global actions (available for all contexts)
# These actions are available in every context and can be overridden by per-context actions
# Story 6.2: All actions execute locally with template variable substitution
actions:
  - name: "View Logs"
    shortcut: "l"
    command: "kubectl logs -n {{.namespace}} {{.pod}} -f --tail=100"

  - name: "Port Forward"
    shortcut: "p"
    command: "kubectl port-forward -n {{.namespace}} {{.pod}} 8080:8080"

  - name: "Describe Pod"
    shortcut: "i"
    command: "kubectl describe pod -n {{.namespace}} {{.pod}}"

# Favorite namespaces - Format A: Per-context map
# Favorites are displayed at the top of the namespace list
favorites:
  production:
    - default
    - api
    - workers
    - monitoring
  staging:
    - default
    - staging-api
  minikube:
    - default
    - dev

# Alternative: Global favorites list (uncomment to use instead of per-context)
# favorites:
#   - my-namespace
#   - another-namespace

contexts:
  # Production context
  - name: production
    # Per-context actions (optional, extend/override global actions)
    actions:
      - name: "Rails Console"
        shortcut: "c"
        command: "kubectl exec -n {{.namespace}} {{.pod}} -it -- bundle exec rails console"

      - name: "Bash Shell"
        shortcut: "b"
        command: "kubectl exec -n {{.namespace}} {{.pod}} -it -- /bin/bash"

      - name: "DB Shell (Multi-container pod example)"
        shortcut: "d"
        command: "kubectl exec -n {{.namespace}} {{.pod}} -c mysql -it -- mysql -u root"

      - name: "Grafana Dashboard"
        shortcut: "g"
        command: "open https://grafana.example.com/d/pod-metrics?var-pod={{.pod}}&var-namespace={{.namespace}}"

      - name: "Kibana Logs"
        shortcut: "k"
        command: "open https://kibana.example.com/app/discover#/?_g=(filters:!((pod:'{{.pod}}')))"

  # Staging context
  - name: staging
    actions:
      - name: "Shell"
        shortcut: "s"
        command: "kubectl exec -n {{.namespace}} {{.pod}} -it -- /bin/sh"

      - name: "Debug Shell"
        shortcut: "d"
        command: "kubectl exec -n {{.namespace}} {{.pod}} -it -- /bin/bash -l"

      - name: "Staging Dashboard"
        shortcut: "g"
        command: "open https://dashboard.staging.example.com/{{.context}}/{{.namespace}}"

  # Development context (local minikube/kind)
  - name: minikube
    actions:
      - name: "Shell"
        shortcut: "s"
        command: "kubectl exec -n {{.namespace}} {{.pod}} -it -- /bin/sh"

      - name: "Local Logs"
        shortcut: "v"
        command: "kubectl logs -n {{.namespace}} {{.pod}} -f"

# Template Variables Available in Commands:
# {{.context}}    - Current Kubernetes context name
# {{.namespace}}  - Selected namespace
# {{.pod}}        - Manually selected pod name
#
# Story 6.2 Changes:
# - All actions execute as local shell commands
# - User must manually select a pod before executing actions (Tab â†’ Enter to confirm)
# - For multi-container pods, specify container in command: -c container-name
# - No pod_pattern matching - full manual pod selection workflow
#
# Examples:
# - kubectl exec: "kubectl exec -n {{.namespace}} {{.pod}} -it -- /bin/bash"
# - kubectl exec with specific container: "kubectl exec -n {{.namespace}} {{.pod}} -c mysql -it -- /bin/bash"
# - kubectl logs: "kubectl logs -n {{.namespace}} {{.pod}} -f --tail=100"
# - kubectl logs with container: "kubectl logs -n {{.namespace}} {{.pod}} -c app -f"
# - Open URL: "open https://dashboard.example.com/{{.context}}/{{.namespace}}"
# - Port forward: "kubectl port-forward -n {{.namespace}} {{.pod}} 3000:3000"
# - Local script: "./scripts/debug.sh {{.context}} {{.namespace}} {{.pod}}"
